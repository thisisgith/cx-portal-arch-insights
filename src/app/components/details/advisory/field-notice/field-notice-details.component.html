<cui-tabs id="detailTabs"
	[activeTabIndex]="activeTab"
	(activeTabIndexChange)="activeTab = $event">
	<cui-tab [label]="'_Summary_' | i18n | uppercase">
		<ng-container *ngTemplateOutlet="summary"></ng-container>
	</cui-tab>
	<cui-tab label="{{ '_ImpactedAssets_' | i18n | uppercase }} ({{ impactedCount }})"
		[disabled]="!impactedCount || impactedCount === 0"
		*ngIf="data?.assetIds?.impacted || data?.assetIds?.potentiallyImpacted">
		<div class="half-margin-top">
			<advisory-impacted-assets
				[customerId]="customerId"
				[assetIds]="data.assetIds"
				(impactedCount)="impactedCount = $event"
				(assets)="assets.emit($event)">
			</advisory-impacted-assets>
		</div>
	</cui-tab>
</cui-tabs>

<ng-template #summary>
	<div *ngIf="!isLoading">
			<div class="base-margin-top base-margin-bottom descriptionHeight">
			<ng-container *ngTemplateOutlet="detailText; context: {
					title: ('_Title_' | i18n),
					text: data?.bulletin?.bulletinTitle
				}">
			</ng-container>
			<ng-container *ngTemplateOutlet="detailText; context: {
					title: ('_ProblemDescription_' | i18n),
					text: data?.bulletin?.description
				}">
			</ng-container>
			<ng-container *ngTemplateOutlet="detailText; context: {
					title: ('_Background_' | i18n),
					text: data?.bulletin?.background
				}">
			</ng-container>
			<ng-container *ngTemplateOutlet="detailText; context: {
					title: ('_Symptom_' | i18n),
					text: data?.bulletin?.symptom
				}">
			</ng-container>
			<ng-container *ngTemplateOutlet="detailText; context: {
					title: ('_Workaround_' | i18n) + ' / ' + ('_Solution_' | i18n),
					text: data?.bulletin?.workaround || ('_NoWorkarounds_' | i18n)
				}">
			</ng-container>
		</div>

		<advisory-feedback *ngIf="id && customerId"
			class="flex-fill"
			type="field"
			[id]="id"
			[customerId]="customerId"
			(alert)="alertMessage.emit($event)">
		</advisory-feedback>
	</div>

	<div *ngIf="isLoading" class="dbl-margin-top flex-center">
		<cui-spinner></cui-spinner>
	</div>
</ng-template>

<ng-template #detailText let-title="title" let-text="text">
	<div class="base-margin-bottom">
		<div [innerText]="title" class="text-uppercase qtr-margin-bottom content__title"></div>
		<div [innerHTML]="text || ('_NA_' | i18n)" class="content__text"></div>
	</div>
</ng-template>
