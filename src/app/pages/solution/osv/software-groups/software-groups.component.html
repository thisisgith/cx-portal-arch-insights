<div class="row">
	<div class="col-md-9 flex flex-fill">
		<div class="flex-center-vertical" *ngIf="pagination && softwareGroups?.length > 0">
			<span [innerText]="'_OsvSoftwareGroups_' | i18n" class="text-large"></span>
			<span *ngIf="pagination"
				[innerText]="'_OsvShowingXofYSoftwareGroups_' | i18n:paginationCount:pagination.total"
				class="qtr-margin-left text-small text-muted" data-auto-id="ShowingSoftwareGroupsCount">
			</span>
		</div>
	</div>
	<div class="col-md-3 text-right">
		<div>
			<span [innerText]="'_CSNeedSoftwareRecommendation_' | i18n"></span>
			<a (click)="contactSupport.emit()" class="recommedation-link text-primary" data-auto-id="ContactExpert" [innerText]="'_CSRequestExpert_' | i18n"></a>
		</div>
	</div>
</div>
<div class="divider qtr-margin-top"></div>
<ng-container *ngTemplateOutlet="tableSoftwareGroups"></ng-container>
<div *ngIf="pagination && softwareGroups?.length > 0" class="base-margin-top">
	<cui-pager [page]="pagination.page - 1" [limit]="pagination.rows" [totalItems]="pagination.total || 0"
		(onPageChanged)="onPageChanged($event)">
	</cui-pager>
</div>
<div *ngIf="status.isLoading">
	<cui-spinner></cui-spinner>
</div>

<ng-template #tableSoftwareGroups>
	<div  *ngIf="!status.isLoading && softwareGroupsTable && softwareGroups?.length">
		<table class="table table--selectable table--compressed table--wrap table--lined table--hover">
			<thead>
				<tr>
					<th *ngFor="let column of softwareGroupsTable.columns"
						[ngClass]="{ 'sortable': column.sortable, 'sorted': column.sorting }">
						<span [innerText]="column.name"></span>
						<span *ngIf="column.sortable && column.sorting" class="qtr-margin-left" [ngClass]="{
										'icon-chevron-down': column.sortDirection === 'asc',
										'icon-chevron-up': column.sortDirection === 'desc'
									}">
						</span>
					</th>
				</tr>
			</thead>
			<tbody>
				<tr *ngFor="let item of softwareGroups" (click)="onRowSelect(item)"
					[ngClass]="{ 'active': item.rowSelected }"
					attr.data-auto-id="SoftwareGroups-{{ item.softwareProfile }}">
					<td *ngFor="let column of softwareGroupsTable.columns" [ngStyle]="{ 'width': column.width }"
						(click)="column.click ? $event.stopPropagation() : null"
						attr.data-auto-id="SoftwareGroupsItemClickHandler-{{ item.softwareProfile }}">
						<ng-container *ngIf="column.template">
							<ng-container *ngTemplateOutlet="column.template; context: { celldata: item.data ,actions: item.actions}">
							</ng-container>
						</ng-container>
						<ng-container *ngIf="!column.template">
							<span *ngIf="column.render" [innerHTML]="column.render(item)"></span>
							<span *ngIf="!column.render" [innerText]="item[column.key]"></span>
						</ng-container>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</ng-template>

<ng-template #recommendationsTemplate let-item="celldata">
	<div *ngIf="item?.recommendations && item.recommendations.length >0 ">
		<span class="icon-lightbulb icon-small"></span>
		<sup>{{item.recommendations.length}}</sup>
		<span class="qtr-margin-left" [innerText]="'_OsvAvailable_' | i18n"></span>
	</div>
</ng-template>

<ng-template #actionsTemplate let-item="celldata" let-actions="actions" >
	<cui-dropdown *ngIf="actions?.length > 0 " [actions]="actions" position="left"
		icon="icon-more icon-medium text-muted rotate-90">
	</cui-dropdown>
</ng-template>
