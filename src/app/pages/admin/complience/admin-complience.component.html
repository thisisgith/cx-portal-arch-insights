<admin-wrapper>
	<div class="panel">
		<div class="dbl-padding-left dbl-padding-right">
			<div class="text-xlarge text-uppercase base-margin-bottom"
			[innerText]="'_AdminPolicyTagging_' | i18n">
			</div>
			<div class="text-medium base-margin-bottom"
			[innerText]="'_AdminEnableRegulatoryComplience_' | i18n">
			</div>
			<div class="form-group form-group--inline base-margin-bottom"
			*ngIf="optlnStatus" (click)="toggleOptlnStatus()">
				<label class="switch">
					<input type="checkbox" checked>
					<span class="switch__input"></span>
					<span class="switch__label">On</span>
				</label>
			</div>
			<div class="form-group form-group--inline base-margin-bottom"
			*ngIf="!optlnStatus" (click)="optlnStatus = !optlnStatus; updateOptInOutStatus();">
					<label class="switch">
						<input type="checkbox" >
						<span class="switch__input"></span>
						<span class="switch__label">Off</span>
					</label>
				</div>

				<div class="row">
					<div class="col-md-4">
						<div class="alert alert--info">
								<div class="alert__icon icon-info-outline"></div>
							<div class="alert__message" [innerText]="'_AdminEnableRegulatoryComplienceNote_' | i18n">
								</div>
							</div>
						</div>
						</div>

				<cui-alert [options]="alert"></cui-alert>

				<div *ngIf="optlnStatus" class="base-margin-top">

						<div class="row base-margin-bottom">
								<div class="col-md-2 half-margin-right">
								<div class="form-group">
										<div class="form-group__text select">
											<select id="select-type-basic" (change)="onPolicySelected($event.target.value)" [(ngModel)]="selectedPolicy">
												<option *ngFor="let policy of policies"
											[value]="policy.name" [innerText]="policy.name">
												</option>
											</select>
											<label for="select-type-basic" class="subheader"
											[innerText]="'_AdminPolicy_' | i18n"></label>
										</div>
									</div>
								</div>
								<div class="col-2">
										<div class="subheader">Scan type</div>
										<div class="form-group">
											<label class="radio" [ngClass]="{'disabled': saveDetails.body.policy=='select'}">
												<input type="radio" name="radio-stacked" checked
										value="allDevices" name="inline-radio" [(ngModel)]="selectedDeviceTagType" (change)="onChangesDeviceTagType()">
												<span class="radio__input"></span>
												<span class="radio__label">All Inventory</span>
											</label>
										</div>
										<div class="form-group">
												<label class="radio" [ngClass]="{'disabled': saveDetails.body.policy=='select'}">
													<input type="radio" name="radio-stacked"
										value="selectedTags" name="inline-radio" [(ngModel)]="selectedDeviceTagType" (change)="onChangesDeviceTagType()">
													<span class="radio__input"></span>
													<span class="radio__label">System Tags</span>
												</label>
											</div>
								</div>
								<div class="col-md-2" *ngIf="saveDetails.body.policy != 'select'">
										<div class="form-group form-group--inline base-margin-bottom" *ngIf="toBeScanned">
												<div class="subheader qtr-margin-bottom">Enable Scan
														<sup>
																<div
																	tooltip
																	[tooltipTemplate]="policyTooltipContentTemplate"
																	class="icon-info-outline"
																	[tooltipMaxWidth]="200"
																></div
															></sup>
												</div>

												<label class="switch">
													<input type="checkbox" checked (click)="toBeScanned = !toBeScanned">
													<span class="switch__input"></span>
													<span class="switch__label">Yes</span>
												</label>
											</div>
											<div class="form-group form-group--inline base-margin-bottom" *ngIf="!toBeScanned">
													<div class="subheader qtr-margin-bottom">Enable Scan
															<sup>
																	<div
																		tooltip
																		[tooltipTemplate]="policyTooltipContentTemplate"
																		class="icon-info-outline"
																		[tooltipMaxWidth]="200"
																	></div
																></sup>
													</div>
													<label class="switch">
														<input type="checkbox" (click)="toBeScanned = !toBeScanned">
														<span class="switch__input"></span>
														<span class="switch__label">No</span>
													</label>
												</div>
										</div>
								<div class="col-5">
								<div class="row">
									<div class="col-12 flex-end" *ngIf="saveDetails.body.policy != 'select'">
											<button class="btn btn--small btn--primary half-margin-top" (click)="savePolicyDetails()"
											[innerText]="'_Save_' | i18n"
											[ngClass]="{'disabled': !enableSaveButton}"></button>
										</div>
							</div>
							</div>
						</div>
					</div>
				<div [hidden]= "selectedDeviceTagType == 'allDevices' || saveDetails.body.policy == 'select'">
					<div class="text-large"  
					[innerText]="'_AdminPolicyTaggingHeading_' | i18n"></div>
			

			<asset-tagging 
				[tagListLeft]='leftSideTags' [tagListRight]='rightSideTags'
				(updatedTags)="getUpdatedTags($event)"></asset-tagging>
			</div></div>
	</div>
</admin-wrapper>

<cui-modal></cui-modal>

<ng-template #confirmationModalTemplate>
	<a class="modal__close" (click)="cuiModalService.hide()"><span class="icon-close"></span></a>
	<div class="modal__header">
		<h6 class="modal__title">Confirm Compliance Off</h6>
	</div>
	<div class="modal__body">
		<p class="subtitle">All policy tagging and violation data will be permanently deleted</p>
	</div>
	<div class="modal__footer">
		<button class="btn" (click)="discardChanges()">Delete Data</button>
		<button class="btn" (click)="saveChanges()">Cancel</button>
	</div>
</ng-template>

<ng-template #switchBetweenPolicy>
	<a class="modal__close" (click)="cuiModalService.hide()"><span class="icon-close"></span></a>
	<div class="modal__header">
		<h6 class="modal__title">Selected Tags not saved</h6>
	</div>
	<div class="modal__body">
		<p class="subtitle">Current policy group tags are not saved.</p>
		<p> Unsaved changes will be lost</p>
	</div>
	<div class="modal__footer">
		<button class="btn" (click)="onCancelPolicyChanges()">Cancel</button>
		<button class="btn btn" (click)="discardChangesOnPolicyChange()">Continue without saving</button>
	</div>
</ng-template>

<ng-template #policyTooltipContentTemplate>
	<span>Policy level opt in/out will enable/disable policy rule execution on selected tags/devices</span>
</ng-template>

