import {
	SecurityAdvisoryImpactCountResponse,
	SecurityAdvisoryImpactedInfoAndCount,
	ProductAlertsPagination as Pagination,
} from '@sdp-api';
import * as _ from 'lodash-es';
/** Base of URL for SDP API */
const api = '/api/customerportal/product-alerts/v1/security-advisories/top';

/** Default Customer ID */
const customerId = '2431199';

/** The mock response for coverage counts */
const mockAdvisoryResponse: SecurityAdvisoryImpactedInfoAndCount[] = [
	/* tslint:disable */
	{
		psirtId: "0000001",
		headline: "Cisco IOS XE Software Authentication, Authorization, and Accounting Login Authentication failure discoverd when too many simultaneous inactive logins.",
		severity: "Critical",
		publishedDate: "2019-03-03T00:00:00+0000",
		revisedDate: "2019-03-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 5,
	},
	{
		psirtId: "0000002",
		headline: "Cisco Small Business Series Switches Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2018-08-02T00:00:00+0000",
		revisedDate: "2018-08-02T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000003",
		headline: "Cisco FXOS and NX-OS Software Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2019-02-18T00:00:00+0000",
		revisedDate: "2019-02-18T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000004",
		headline: "Cisco Unified Computing System BIOS Signature Bypass Vulnerability",
		severity: "Medium",
		publishedDate: "2019-10-14T00:00:00+0000",
		revisedDate: "2019-10-14T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000005",
		headline: "Cisco Identity Services Engine Privileged Account Sensitive Information Disclosure Vulnerability",
		severity: "Medium",
		publishedDate: "2019-04-19T00:00:00+0000",
		revisedDate: "2019-04-19T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 0,
	},
	{
		psirtId: "0000006",
		headline: "Cisco Secure ACS Unix Acme.server Information Disclosure Vulnerability",
		severity: "Low",
		publishedDate: "2019-09-21T00:00:00+0000",
		revisedDate: "2019-09-21T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000001",
		headline: "Cisco IOS XE Software Authentication, Authorization, and Accounting Login Authentication failure discoverd when too many simultaneous inactive logins.",
		severity: "Critical",
		publishedDate: "2019-03-03T00:00:00+0000",
		revisedDate: "2019-03-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 5,
	},
	{
		psirtId: "0000002",
		headline: "Cisco Small Business Series Switches Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2018-08-02T00:00:00+0000",
		revisedDate: "2018-08-02T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000003",
		headline: "Cisco FXOS and NX-OS Software Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2019-02-18T00:00:00+0000",
		revisedDate: "2019-02-18T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000004",
		headline: "Cisco Unified Computing System BIOS Signature Bypass Vulnerability",
		severity: "Medium",
		publishedDate: "2019-10-14T00:00:00+0000",
		revisedDate: "2019-10-14T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000005",
		headline: "Cisco Identity Services Engine Privileged Account Sensitive Information Disclosure Vulnerability",
		severity: "Medium",
		publishedDate: "2019-04-19T00:00:00+0000",
		revisedDate: "2019-04-19T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 0,
	},
	{
		psirtId: "0000006",
		headline: "Cisco Secure ACS Unix Acme.server Information Disclosure Vulnerability",
		severity: "Low",
		publishedDate: "2019-09-21T00:00:00+0000",
		revisedDate: "2019-09-21T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000001",
		headline: "Cisco IOS XE Software Authentication, Authorization, and Accounting Login Authentication failure discoverd when too many simultaneous inactive logins.",
		severity: "Critical",
		publishedDate: "2019-03-03T00:00:00+0000",
		revisedDate: "2019-03-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 5,
	},
	{
		psirtId: "0000002",
		headline: "Cisco Small Business Series Switches Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2018-08-02T00:00:00+0000",
		revisedDate: "2018-08-02T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000003",
		headline: "Cisco FXOS and NX-OS Software Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2019-02-18T00:00:00+0000",
		revisedDate: "2019-02-18T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000004",
		headline: "Cisco Unified Computing System BIOS Signature Bypass Vulnerability",
		severity: "Medium",
		publishedDate: "2019-10-14T00:00:00+0000",
		revisedDate: "2019-10-14T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000005",
		headline: "Cisco Identity Services Engine Privileged Account Sensitive Information Disclosure Vulnerability",
		severity: "Medium",
		publishedDate: "2019-04-19T00:00:00+0000",
		revisedDate: "2019-04-19T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 0,
	},
	{
		psirtId: "0000006",
		headline: "Cisco Secure ACS Unix Acme.server Information Disclosure Vulnerability",
		severity: "Low",
		publishedDate: "2019-09-21T00:00:00+0000",
		revisedDate: "2019-09-21T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000001",
		headline: "Cisco IOS XE Software Authentication, Authorization, and Accounting Login Authentication failure discoverd when too many simultaneous inactive logins.",
		severity: "Critical",
		publishedDate: "2019-03-03T00:00:00+0000",
		revisedDate: "2019-03-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 5,
	},
	{
		psirtId: "0000002",
		headline: "Cisco Small Business Series Switches Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2018-08-02T00:00:00+0000",
		revisedDate: "2018-08-02T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000003",
		headline: "Cisco FXOS and NX-OS Software Simple Network Management Protocol Denial of Service Vulnerability",
		severity: "High",
		publishedDate: "2019-02-18T00:00:00+0000",
		revisedDate: "2019-02-18T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 3,
	},
	{
		psirtId: "0000004",
		headline: "Cisco Unified Computing System BIOS Signature Bypass Vulnerability",
		severity: "Medium",
		publishedDate: "2019-10-14T00:00:00+0000",
		revisedDate: "2019-10-14T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000005",
		headline: "Cisco Identity Services Engine Privileged Account Sensitive Information Disclosure Vulnerability",
		severity: "Medium",
		publishedDate: "2019-04-19T00:00:00+0000",
		revisedDate: "2019-04-19T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 0,
	},
	{
		psirtId: "0000006",
		headline: "Cisco Secure ACS Unix Acme.server Information Disclosure Vulnerability",
		severity: "Low",
		publishedDate: "2019-09-21T00:00:00+0000",
		revisedDate: "2019-09-21T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	{
		psirtId: "0000007",
		headline: "Offline Cryptographic Attacks Targeting the Wi-Fi Protected Access 2 Protocol",
		severity: "Info",
		publishedDate: "2018-05-03T00:00:00+0000",
		revisedDate: "2018-05-03T00:00:00+0000",
		summary: "",
		advisoryURL: "",
		impactedEntityCount: 1,
	},
	/* tslint:enable */
];

/**
 * Mocks the security advisory response
 * @param rows the rows to return
 * @param page the page to return
 * @returns mock response
 */
function MockAdvisory (
	rows?: number,
	page?: number): SecurityAdvisoryImpactCountResponse {

	let data = _.cloneDeep(mockAdvisoryResponse);
	const total = data.length;
	let pagination: Pagination;
	if (rows && page) {
		data = data.slice((rows * (page - 1)), (rows * page));
		pagination = {
			page,
			rows,
			total,
			pages: Math.ceil(total / rows),
		};
	}

	return {
		data,
		Pagination: pagination,
	};
}

/** The scenarios */
export const SecurityAdvisoryTopScenarios = [
	{
		scenarios: {
			GET: [
				{
					delay: 350,
					description: 'Security Advisories - Top - Page 1',
					response: {
						body: MockAdvisory(10, 1),
						status: 200,
					},
					selected: true,
				},
			],
		},
		url: `${api}?customerId=${customerId}&rows=10&page=1`,
		usecases: ['Use Case 1'],
	},
	{
		scenarios: {
			GET: [
				{
					delay: 350,
					description: 'Security Advisories - Top - Page 2',
					response: {
						body: MockAdvisory(10, 2),
						status: 200,
					},
					selected: true,
				},
			],
		},
		url: `${api}?customerId=${customerId}&rows=10&page=2`,
		usecases: ['Use Case 1'],
	},
	{
		scenarios: {
			GET: [
				{
					delay: 350,
					description: 'Security Advisories - Top - Page 3',
					response: {
						body: MockAdvisory(10, 3),
						status: 200,
					},
					selected: true,
				},
			],
		},
		url: `${api}?customerId=${customerId}&rows=10&page=3`,
		usecases: ['Use Case 1'],
	},
	{
		scenarios: {
			GET: [
				{
					delay: 350,
					description: 'Security Advisories - Top - Page 4',
					response: {
						body: MockAdvisory(10, 4),
						status: 200,
					},
					selected: true,
				},
			],
		},
		url: `${api}?customerId=${customerId}&rows=10&page=4`,
		usecases: ['Use Case 1'],
	},
];
